id: repository_name_can_be_constrained
name: Lowercase repository names
description: Repository names should only contain lowercase characters, numbers, and dashes
owner: iamwillbar@github.com
doc: https://contoso.com/policy/repository_community_files_exist

for: repositories
where:
  - "resource.isPrivate == true"
  - '!resource.name.matches("^[a-z0-9-]+$")'
ensure:
  name: bad-name
